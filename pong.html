<head>
	<title>Pong</title>
	<link rel="icon" type="image/x-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABg2lDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TpUUqDs0g4pChOtlFRTqWKhbBQmkrtOpgcukXNGlJUlwcBdeCgx+LVQcXZ10dXAVB8APE2cFJ0UVK/F9SaBHjwXE/3t173L0DhHaNaeZAHNB0y8gkE1K+sCoFXhGECAFhxGRmNlLZxRw8x9c9fHy9i/Is73N/jmG1aDLAJxHHWcOwiDeI5zatBud9YpFVZJX4nHjKoAsSP3JdcfmNc9lhgWeKRi4zTywSS+U+VvqYVQyNeJY4omo65Qt5l1XOW5y1WpN178lfGCrqK1mu0xxHEktIIQ0JCpqoogYLUVp1UkxkaD/h4R9z/GlyKeSqgpFjAXVokB0/+B/87tYszUy7SaEEMPhi2x8TQGAX6LRs+/vYtjsngP8ZuNJ7/nobiH2S3uppkSNgZBu4uO5pyh5wuQOMPjVkQ3YkP02hVALez+ibCkD4Fhhac3vr7uP0AchRV8s3wMEhMFmm7HWPdwf7e/v3TLe/H8PncsfxuP/dAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH6AgUAhU3VUQvMwAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAA5SURBVDjLY2SAgP8M5AFGRgo0MzAwMDAwMVAIWNCdRKS+/1RzwcAbMPCxQKkBjORGI8MwisaBNwAAcz4EIpvMtXcAAAAASUVORK5CYII=">
</head>
<body style="background-color:black;">
<canvas id="gameCanvas" style="width:100%;height:100%;margin:0px;padding:0px;">The canvas tag is not supported :-(</canvas>
</body>
<script>

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const foregroundColor = "white";
const backgroundColor = "black";
var one = new Audio('1.wav');
var two = new Audio('2.wav');
var three = new Audio('3.wav');
let playerSpeed = 20;
let ballSpeed = 5;
let playerOneY;
let playerTwoY;
let ballX;
let ballY;
let ballDir;
let playerOneScore = 0;
let playerTwoScore = 0;
let updateGame;

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;



function newRound(){
	playerOneY = window.innerHeight / 2;
	playerTwoY = window.innerHeight / 2;
	ballX = window.innerWidth / 2;
	ballY = window.innerHeight / 2;
	ballDir = Math.floor(Math.random() * 360);
	

}

function clearCanvas(){
	ctx.fillStyle = backgroundColor;
	ctx.fillRect(0,0,canvas.width,canvas.height);
	ctx.fillStyle = foregroundColor;
}

function drawPlayers(){
	
	
	
	ctx.fillRect(0,playerOneY,50,200); // player1
	ctx.fillRect(canvas.width - 50,playerTwoY,50,200); // player2
}

function drawBall(){
	
	
	ctx.fillRect(ballX,ballY,20,20);
}

newRound();

addEventListener("keydown", (event) => {
	
	
	
	if(ballX < canvas.width / 2){
	switch(event.key){
	case "w":
		playerOneY -= playerSpeed;
		break;
		
	
	case "s":
		playerOneY += playerSpeed;
		break;
	}
	}
	
	if(ballX > canvas.width / 2){
	switch(event.key){
	
	
	case "i":
		playerTwoY -= playerSpeed;
		break;
		
	
	case "k":
		playerTwoY += playerSpeed;
		break;
		
	}
	}
	
	switch(event.key){
		case "r":
			newRound();
			break;
	}
	
	
	
});



updateGame = setInterval(gameloop,10);


function updateBall(){
	drawBall();
	
	// ball position update
	
	ballX += (Math.sin(ballDir) * ballSpeed);
	ballY -= (Math.cos(ballDir) * ballSpeed);
	
	
}

function bounce(){
	ballDir += ballDir % 180;
	
}
	

function checkCollisions(){
	// ball
	
	if(ballX < canvas.width / 2 && ballY > playerOneY && ballY + 200 > ballY && ballX < 60){ // if touching player1
		bounce();
	}
	
	if(ballX > canvas.width / 2 && ballY > playerTwoY && ballY + 200 > ballY && ballX > canvas.width - 60){ // if touching player2
		bounce();
	}
	
	if(ballX < 1){
		playerTwoScore++;
		newRound();
	}
	if(ballX > canvas.width){
		playerOneScore++;
		newRound();
	}
	
	if(ballY < 10){
		bounce();
	}
	
	if(ballY > canvas.height){
		bounce();
	}
}

function drawScoreboard(){
	ctx.font = "48px Pixelify Sans";
	
	ctx.fillText(playerOneScore,10,50);
	ctx.fillText(playerTwoScore,canvas.width - 10 * toString(playerTwoScore).length,50);
}


function drawMiddleLine(){
	ctx.fillRect(canvas.width / 2, 0, 1, canvas.height);
}

function gameloop(){
	clearCanvas();
	
	drawMiddleLine();
	
	drawPlayers();
	
	updateBall();
	
	drawScoreboard();
	
	
	checkCollisions();
}


</script>
